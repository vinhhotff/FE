(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{283:(e,a,s)=>{"use strict";s.d(a,{A:()=>c,AuthProvider:()=>d});var t=s(5155),r=s(2115),l=s(722),n=s(7383),o=s(3568);let i=(0,r.createContext)(void 0),c=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e};function d(e){let{children:a}=e,[s,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0);async function m(e){try{console.log("Starting login process...");try{let a=await (0,l.iD)(e);if(console.log("Login response:",a.data),!a.data||!a.data.data||!a.data.data.user)return o.Ay.error("Invalid email or password. Please try again."),{success:!1};{let e=a.data.data.user,s=a.data.data.accessToken;c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),o.Ay.success("Welcome back, ".concat(e.name,"!"));let t=e.role.toLowerCase();return{success:!0,role:t}}}catch(e){var a,s,t,r,n,i,d;return console.error("API Error in loginUser:",e),(null==(a=e.response)?void 0:a.status)===400||(null==(s=e.response)?void 0:s.status)===401?o.Ay.error("Invalid email or password. Please try again."):(null==(t=e.response)?void 0:t.status)===403?o.Ay.error("Access denied. Please check your credentials."):(null==(r=e.response)?void 0:r.status)>=500?o.Ay.error("Server error. Please try again later."):"NETWORK_ERROR"===e.code||(null==(n=e.message)?void 0:n.includes("Network Error"))?o.Ay.error("Network error. Please check your connection."):(null==(d=e.response)||null==(i=d.data)?void 0:i.message)?o.Ay.error(e.response.data.message):"AxiosError"===e.name?o.Ay.error("Login failed. Please check your credentials and try again."):o.Ay.error("Login failed. Please try again."),{success:!1}}}catch(e){return console.error("Outer error in loginUser:",e),o.Ay.error("An unexpected error occurred. Please try again."),{success:!1}}}async function g(e){try{let a=await (0,l.iD)(e);if(console.log("Admin login response:",a.data),a.data&&a.data.data&&a.data.data.user){let e=a.data.data.user,s=a.data.data.accessToken;if("admin"!==e.role.toLowerCase())return o.Ay.error("Access denied. Admin privileges required."),!1;return c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),o.Ay.success("Welcome back, Admin ".concat(e.name,"!")),!0}o.Ay.error("Invalid email or password. Please try again.")}catch(e){var a,s,t,r,n,i;console.error("Admin login failed:",e),(null==(a=e.response)?void 0:a.status)===400||(null==(s=e.response)?void 0:s.status)===401?o.Ay.error("Invalid email or password. Please try again."):(null==(t=e.response)?void 0:t.status)===403?o.Ay.error("Access denied. Admin privileges required."):(null==(r=e.response)?void 0:r.status)>=500?o.Ay.error("Server error. Please try again later."):(null==(i=e.response)||null==(n=i.data)?void 0:n.message)?o.Ay.error(e.response.data.message):o.Ay.error("Login failed. Please try again.")}return!1}async function x(e){try{let a=await (0,l.mQ)(e);if(console.log("Staff login response:",a.data),a.data&&a.data.data&&a.data.data.user){let e=a.data.data.user,s=a.data.data.accessToken;return c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),o.Ay.success("Welcome back, ".concat(e.name,"!")),!0}o.Ay.error("Invalid email or password. Please try again.")}catch(e){var a,s,t,r,n,i;console.error("Staff login failed:",e),(null==(a=e.response)?void 0:a.status)===400||(null==(s=e.response)?void 0:s.status)===401?o.Ay.error("Invalid email or password. Please try again."):(null==(t=e.response)?void 0:t.status)===403?o.Ay.error("Access denied. Staff privileges required."):(null==(r=e.response)?void 0:r.status)>=500?o.Ay.error("Server error. Please try again later."):(null==(i=e.response)||null==(n=i.data)?void 0:n.message)?o.Ay.error(e.response.data.message):o.Ay.error("Login failed. Please try again.")}return!1}async function h(e){try{await (0,l.ri)(),console.log("Logout API called successfully")}catch(e){console.error("Logout API failed:",e)}n.A.remove("123123"),c(null),localStorage.removeItem("user"),localStorage.removeItem("accessToken"),o.Ay.success("Logged out successfully");let a=e||"/login";setTimeout(()=>{window.location.href=a},1500)}return(0,r.useEffect)(()=>{!async function(){u(!0);let e=localStorage.getItem("user"),a=localStorage.getItem("accessToken");if(e&&a)try{c(JSON.parse(e)),u(!1);return}catch(e){localStorage.removeItem("user"),localStorage.removeItem("accessToken")}if(!e||!a)try{let e=await (0,l.Ow)();if(e.data&&e.data.data&&e.data.data.user){let a=e.data.data.user,s=e.data.data.accessToken;c(a),localStorage.setItem("user",JSON.stringify(a)),localStorage.setItem("accessToken",s)}else c(null)}catch(e){c(null)}u(!1)}()},[]),(0,t.jsx)(i.Provider,{value:{user:s,loading:d,login:m,loginAdmin:g,loginStaff:x,logout:h},children:a})}},722:(e,a,s)=>{"use strict";s.d(a,{Ow:()=>n,gL:()=>i,iD:()=>r,mQ:()=>l,ri:()=>o});let t=s(3464).A.create({baseURL:"http://localhost:8083/api/v1",withCredentials:!0});t.interceptors.request.use(e=>{let a=localStorage.getItem("accessToken");return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),t.interceptors.response.use(e=>e,e=>{var a,s,t,r;return(null==(s=e.config)||null==(a=s.url)?void 0:a.includes("/auth/login"))&&((null==(t=e.response)?void 0:t.status)===400||(null==(r=e.response)?void 0:r.status)===401)?Promise.resolve({error:e.response}):Promise.reject(e)});let r=e=>t.post("/auth/login",e),l=e=>t.post("/auth/login-staff",e),n=()=>t.get("/auth/refresh"),o=()=>t.post("/auth/logout"),i=e=>t.get("/menu-items",{params:e})},3792:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>c});var t=s(5155),r=s(6874),l=s.n(r),n=s(4300),o=s(283),i=s(2115);function c(){let{user:e}=(0,o.A)(),[a,s]=(0,i.useState)(null),{data:r,isLoading:c,error:d}=(0,n.T)(),u=r?[...new Set(r.map(e=>e.category).filter(Boolean))]:[],m=a?null==r?void 0:r.filter(e=>e.category===a):r;return(0,t.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,t.jsx)("section",{className:"relative h-96 bg-gradient-to-r from-amber-600 to-orange-600",children:(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center text-white",children:[(0,t.jsx)("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Welcome to La Bella Vita"}),(0,t.jsx)("p",{className:"text-lg md:text-xl mb-6",children:"Savor the finest Italian cuisine in town"}),(0,t.jsx)(l(),{href:"#menu",className:"inline-block px-6 py-3 bg-white text-amber-600 rounded-lg hover:bg-gray-100 font-semibold",children:"View Menu"})]})})}),(0,t.jsx)("section",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"flex justify-center"})}),(0,t.jsx)("section",{className:"container mx-auto px-4 py-12",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold mb-6",children:"Quick Order with QR Code"}),(0,t.jsx)("p",{className:"text-lg text-gray-600 mb-8",children:"Scan the QR code to view our menu and place your order instantly!"}),(0,t.jsxs)("div",{className:"max-w-md mx-auto bg-white p-8 shadow-lg rounded-lg",children:[(0,t.jsx)("div",{className:"w-48 h-48 mx-auto bg-gray-200 flex items-center justify-center rounded-lg mb-4",children:(0,t.jsx)("span",{className:"text-gray-500",children:"QR Code Placeholder"})}),(0,t.jsx)("button",{className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold",children:"Scan QR Code"})]})]})}),(0,t.jsxs)("section",{id:"menu",className:"container mx-auto px-4 py-12",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-center mb-8",children:"Our Menu"}),u.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 mb-8",children:[(0,t.jsx)("button",{onClick:()=>s(null),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 ".concat(null===a?"bg-amber-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"All Items"}),u.map(e=>(0,t.jsx)("button",{onClick:()=>s(e),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 capitalize ".concat(a===e?"bg-amber-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e},e))]}),c&&(0,t.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-500"}),(0,t.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading menu items..."})]}),d&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[(0,t.jsx)("p",{className:"text-red-600 font-medium",children:"Failed to load menu items"}),(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:"Please try refreshing the page"})]}),!c&&!d&&(null==m?void 0:m.length)===0&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("p",{className:"text-gray-600 text-lg",children:"No menu items found"}),a&&(0,t.jsx)("p",{className:"text-gray-500 text-sm mt-2",children:"Try selecting a different category or view all items"})]}),!c&&!d&&m&&m.length>0&&(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(a=>(0,t.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"h-48 bg-gradient-to-br from-amber-200 to-orange-300 flex items-center justify-center",children:(0,t.jsx)("img",{src:a.image||"placeholder.jpg",alt:a.name,className:"h-full w-full object-cover"})}),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold",children:a.name}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1",children:["$",a.price.toFixed(2)]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:a.description}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium ".concat(a.isAvailable?"text-green-600":"text-red-600"),children:a.isAvailable?"✓ Available":"✗ Out of Stock"}),a.category&&(0,t.jsx)("span",{className:"text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full",children:a.category})]}),(0,t.jsx)("button",{className:"mt-4 w-full px-4 py-2 rounded font-semibold transition-colors duration-200 ".concat(a.isAvailable?"bg-amber-500 text-white hover:bg-amber-600":"bg-gray-300 text-gray-500 cursor-not-allowed"),disabled:!a.isAvailable,children:a.isAvailable?"Add to Cart":"Unavailable"}),e&&("ADMIN"===e.role||"STAFF"===e.role||"admin"===e.role||"staff"===e.role)&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["ID: ",a._id]})]})]},a._id))})]}),(0,t.jsxs)("section",{className:"container mx-auto px-4 py-12 bg-white",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-center mb-8",children:"Staff Management"}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Order Management"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Track and manage incoming orders efficiently"}),(0,t.jsx)("button",{className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"View Orders"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 p-6 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-xl font-semibold mb-4",children:"Staff Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Access staff schedules and notifications"}),(0,t.jsx)("button",{className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Staff Login"})]})]})})]})]})}},4300:(e,a,s)=>{"use strict";s.d(a,{T:()=>l});var t=s(2960),r=s(722);function l(e){return(0,t.I)({queryKey:["menuItems",e],queryFn:()=>(0,r.gL)(e).then(e=>e.data.data)})}},9052:(e,a,s)=>{Promise.resolve().then(s.bind(s,3792))}},e=>{e.O(0,[373,441,964,358],()=>e(e.s=9052)),_N_E=e.O()}]);