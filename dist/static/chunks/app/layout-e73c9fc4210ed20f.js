(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{139:(e,r,s)=>{"use strict";s.d(r,{QueryProvider:()=>l});var a=s(5155),t=s(432),o=s(6715),n=s(2115);function l(e){let{children:r}=e,[s]=(0,n.useState)(()=>new t.E({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,refetchOnWindowFocus:!1,retry:(e,r)=>{var s,a;return(!((null==r||null==(s=r.response)?void 0:s.status)>=400)||!((null==r||null==(a=r.response)?void 0:a.status)<500))&&e<3}}}}));return(0,a.jsx)(o.Ht,{client:s,children:r})}},283:(e,r,s)=>{"use strict";s.d(r,{A:()=>c,AuthProvider:()=>d});var a=s(5155),t=s(2115),o=s(722),n=s(7383),l=s(3568);let i=(0,t.createContext)(void 0),c=()=>{let e=(0,t.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e};function d(e){let{children:r}=e,[s,c]=(0,t.useState)(null),[d,u]=(0,t.useState)(!0);async function m(e){try{console.log("Starting login process...");try{let r=await (0,o.iD)(e);if(console.log("Login response:",r.data),!r.data||!r.data.data||!r.data.data.user)return l.Ay.error("Invalid email or password. Please try again."),{success:!1};{let e=r.data.data.user,s=r.data.data.accessToken;c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),l.Ay.success("Welcome back, ".concat(e.name,"!"));let a=e.role.toLowerCase();return{success:!0,role:a}}}catch(e){var r,s,a,t,n,i,d;return console.error("API Error in loginUser:",e),(null==(r=e.response)?void 0:r.status)===400||(null==(s=e.response)?void 0:s.status)===401?l.Ay.error("Invalid email or password. Please try again."):(null==(a=e.response)?void 0:a.status)===403?l.Ay.error("Access denied. Please check your credentials."):(null==(t=e.response)?void 0:t.status)>=500?l.Ay.error("Server error. Please try again later."):"NETWORK_ERROR"===e.code||(null==(n=e.message)?void 0:n.includes("Network Error"))?l.Ay.error("Network error. Please check your connection."):(null==(d=e.response)||null==(i=d.data)?void 0:i.message)?l.Ay.error(e.response.data.message):"AxiosError"===e.name?l.Ay.error("Login failed. Please check your credentials and try again."):l.Ay.error("Login failed. Please try again."),{success:!1}}}catch(e){return console.error("Outer error in loginUser:",e),l.Ay.error("An unexpected error occurred. Please try again."),{success:!1}}}async function g(e){try{let r=await (0,o.iD)(e);if(console.log("Admin login response:",r.data),r.data&&r.data.data&&r.data.data.user){let e=r.data.data.user,s=r.data.data.accessToken;if("admin"!==e.role.toLowerCase())return l.Ay.error("Access denied. Admin privileges required."),!1;return c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),l.Ay.success("Welcome back, Admin ".concat(e.name,"!")),!0}l.Ay.error("Invalid email or password. Please try again.")}catch(e){var r,s,a,t,n,i;console.error("Admin login failed:",e),(null==(r=e.response)?void 0:r.status)===400||(null==(s=e.response)?void 0:s.status)===401?l.Ay.error("Invalid email or password. Please try again."):(null==(a=e.response)?void 0:a.status)===403?l.Ay.error("Access denied. Admin privileges required."):(null==(t=e.response)?void 0:t.status)>=500?l.Ay.error("Server error. Please try again later."):(null==(i=e.response)||null==(n=i.data)?void 0:n.message)?l.Ay.error(e.response.data.message):l.Ay.error("Login failed. Please try again.")}return!1}async function h(e){try{let r=await (0,o.mQ)(e);if(console.log("Staff login response:",r.data),r.data&&r.data.data&&r.data.data.user){let e=r.data.data.user,s=r.data.data.accessToken;return c(e),localStorage.setItem("user",JSON.stringify(e)),localStorage.setItem("accessToken",s),l.Ay.success("Welcome back, ".concat(e.name,"!")),!0}l.Ay.error("Invalid email or password. Please try again.")}catch(e){var r,s,a,t,n,i;console.error("Staff login failed:",e),(null==(r=e.response)?void 0:r.status)===400||(null==(s=e.response)?void 0:s.status)===401?l.Ay.error("Invalid email or password. Please try again."):(null==(a=e.response)?void 0:a.status)===403?l.Ay.error("Access denied. Staff privileges required."):(null==(t=e.response)?void 0:t.status)>=500?l.Ay.error("Server error. Please try again later."):(null==(i=e.response)||null==(n=i.data)?void 0:n.message)?l.Ay.error(e.response.data.message):l.Ay.error("Login failed. Please try again.")}return!1}async function x(e){try{await (0,o.ri)(),console.log("Logout API called successfully")}catch(e){console.error("Logout API failed:",e)}n.A.remove("123123"),c(null),localStorage.removeItem("user"),localStorage.removeItem("accessToken"),l.Ay.success("Logged out successfully");let r=e||"/login";setTimeout(()=>{window.location.href=r},1500)}return(0,t.useEffect)(()=>{!async function(){u(!0);let e=localStorage.getItem("user"),r=localStorage.getItem("accessToken");if(e&&r)try{c(JSON.parse(e)),u(!1);return}catch(e){localStorage.removeItem("user"),localStorage.removeItem("accessToken")}if(!e||!r)try{let e=await (0,o.Ow)();if(e.data&&e.data.data&&e.data.data.user){let r=e.data.data.user,s=e.data.data.accessToken;c(r),localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("accessToken",s)}else c(null)}catch(e){c(null)}u(!1)}()},[]),(0,a.jsx)(i.Provider,{value:{user:s,loading:d,login:m,loginAdmin:g,loginStaff:h,logout:x},children:r})}},347:()=>{},722:(e,r,s)=>{"use strict";s.d(r,{Ow:()=>n,gL:()=>i,iD:()=>t,mQ:()=>o,ri:()=>l});let a=s(3464).A.create({baseURL:"http://localhost:8083/api/v1",withCredentials:!0});a.interceptors.request.use(e=>{let r=localStorage.getItem("accessToken");return r&&(e.headers.Authorization="Bearer ".concat(r)),e}),a.interceptors.response.use(e=>e,e=>{var r,s,a,t;return(null==(s=e.config)||null==(r=s.url)?void 0:r.includes("/auth/login"))&&((null==(a=e.response)?void 0:a.status)===400||(null==(t=e.response)?void 0:t.status)===401)?Promise.resolve({error:e.response}):Promise.reject(e)});let t=e=>a.post("/auth/login",e),o=e=>a.post("/auth/login-staff",e),n=()=>a.get("/auth/refresh"),l=()=>a.post("/auth/logout"),i=e=>a.get("/menu-items",{params:e})},4300:(e,r,s)=>{"use strict";s.d(r,{T:()=>o});var a=s(2960),t=s(722);function o(e){return(0,a.I)({queryKey:["menuItems",e],queryFn:()=>(0,t.gL)(e).then(e=>e.data.data)})}},4615:(e,r,s)=>{"use strict";s.d(r,{default:()=>x});var a=s(5155),t=s(6874),o=s.n(t),n=s(283),l=s(4300),i=s(2115),c=s(3418),d=s(4170),u=s(7186),m=s(5596),g=s(4500),h=s(9598);function x(){let{user:e,logout:r}=(0,n.A)(),{data:s}=(0,l.T)(),[t,x]=(0,i.useState)(!1),[f,p]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1),b=s?[...new Set(s.map(e=>e.category).filter(Boolean))]:[],N=e=>{let r=document.getElementById("menu");r&&r.scrollIntoView({behavior:"smooth"})};return(0,a.jsx)("header",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg sticky top-0 z-50",children:(0,a.jsxs)("nav",{className:"container mx-auto px-4 py-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(o(),{href:"/",className:"text-2xl font-bold hover:text-orange-200 transition-colors duration-200",children:"\uD83C\uDF7D️ La Bella Vita"}),(0,a.jsxs)("div",{className:"hidden lg:flex items-center space-x-8",children:[(0,a.jsx)(o(),{href:"/",className:"hover:text-orange-200 transition-colors duration-200 font-medium",children:"Home"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>p(e=>!e),className:"flex items-center space-x-1 hover:text-orange-200 transition-colors duration-200 font-medium",children:[(0,a.jsx)("span",{children:"Our Menu"}),(0,a.jsx)(c.A,{className:"w-4 h-4 transition-transform duration-200 ".concat(f?"rotate-180":"")})]}),f&&(0,a.jsxs)("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 py-2 z-50",children:[(0,a.jsx)("button",{onClick:()=>{N(),p(!1)},className:"w-full text-left px-4 py-2 text-gray-800 hover:bg-orange-50 transition-colors duration-200",children:"View All Items"}),b.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-2"}),(0,a.jsx)("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Categories"}),b.map(e=>(0,a.jsx)("button",{onClick:()=>{N(e),p(!1)},className:"w-full text-left px-4 py-2 text-gray-800 hover:bg-orange-50 transition-colors duration-200 capitalize",children:e},e))]}),s&&s.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("hr",{className:"my-2"}),(0,a.jsx)("div",{className:"px-4 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Popular Items"}),(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto",children:s.slice(0,6).map(e=>(0,a.jsx)("button",{onClick:()=>{N(),p(!1)},className:"w-full text-left px-4 py-2 text-gray-800 hover:bg-orange-50 transition-colors duration-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"truncate",children:e.name}),(0,a.jsxs)("span",{className:"text-orange-600 font-semibold ml-2",children:["$",e.price.toFixed(2)]})]})},e._id))})]})]})]}),(0,a.jsx)(o(),{href:"#about",className:"hover:text-orange-200 transition-colors duration-200 font-medium",children:"About"}),e?(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>y(e=>!e),className:"flex items-center space-x-2 px-3 py-2 bg-orange-600 hover:bg-orange-700 rounded-full text-white font-medium focus:outline-none focus:ring",children:[(0,a.jsx)(d.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"hidden md:inline-block",children:e.name}),(0,a.jsx)(c.A,{className:"w-4 h-4 transition-transform duration-200 ".concat(v?"rotate-180":"")})]}),v&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white text-gray-800 z-50 animate-fade-in",children:[(0,a.jsxs)("div",{className:"px-4 pt-4 pb-2 border-b",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.role}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.email})]}),(0,a.jsxs)("ul",{className:"py-2",children:[(0,a.jsx)("li",{children:(0,a.jsxs)(o(),{href:"admin"===e.role||"ADMIN"===e.role?"/admin/dashboard":"staff"===e.role||"STAFF"===e.role?"/staff/dashboard":"/user/home",className:"flex items-center px-4 py-2 hover:bg-orange-50 transition",onClick:()=>y(!1),children:[(0,a.jsx)(u.A,{className:"w-4 h-4 mr-2"})," Dashboard"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>{y(!1),r()},className:"flex items-center w-full px-4 py-2 text-left hover:bg-orange-50 transition",children:[(0,a.jsx)(m.A,{className:"w-4 h-4 mr-2"})," Logout"]})})]})]})]}):(0,a.jsx)(o(),{href:"/login",className:"bg-white text-orange-600 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 font-medium",children:"Login"})]}),(0,a.jsx)("button",{onClick:()=>x(!t),className:"lg:hidden p-2 rounded-lg hover:bg-orange-600 transition-colors duration-200",children:t?(0,a.jsx)(g.A,{className:"w-6 h-6"}):(0,a.jsx)(h.A,{className:"w-6 h-6"})})]}),t&&(0,a.jsx)("div",{className:"lg:hidden mt-4 pb-4 border-t border-orange-400 pt-4",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,a.jsx)(o(),{href:"/",className:"hover:text-orange-200 transition-colors duration-200 font-medium",onClick:()=>x(!1),children:"Home"}),(0,a.jsx)("button",{onClick:()=>{N(),x(!1)},className:"text-left hover:text-orange-200 transition-colors duration-200 font-medium",children:"Our Menu"}),(0,a.jsx)(o(),{href:"#about",className:"hover:text-orange-200 transition-colors duration-200 font-medium",onClick:()=>x(!1),children:"About"}),e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-orange-200 font-medium",children:["Welcome, ",e.name," (",e.role,")"]}),(0,a.jsx)(o(),{href:"admin"===e.role||"ADMIN"===e.role?"/admin/dashboard":"staff"===e.role||"STAFF"===e.role?"/staff/dashboard":"/user/home",className:"hover:text-orange-200 transition-colors duration-200 font-medium",onClick:()=>x(!1),children:"Dashboard"}),(0,a.jsx)("button",{onClick:()=>{r(),x(!1)},className:"text-left bg-orange-600 hover:bg-orange-700 px-4 py-2 rounded-lg transition-colors duration-200 font-medium w-fit",children:"Logout"})]}):(0,a.jsx)(o(),{href:"/login",className:"bg-white text-orange-600 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 font-medium w-fit",onClick:()=>x(!1),children:"Login"})]})})]})})}},6223:(e,r,s)=>{Promise.resolve().then(s.t.bind(s,2093,23)),Promise.resolve().then(s.t.bind(s,7735,23)),Promise.resolve().then(s.bind(s,3568)),Promise.resolve().then(s.t.bind(s,347,23)),Promise.resolve().then(s.bind(s,4615)),Promise.resolve().then(s.bind(s,283)),Promise.resolve().then(s.bind(s,139))}},e=>{e.O(0,[360,373,137,441,964,358],()=>e(e.s=6223)),_N_E=e.O()}]);